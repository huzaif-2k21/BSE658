"0","sleep2 %>% pull(Subject) %>% is.factor()"
"1","[1]"
"1"," TRUE"
"1","
"
"0","np_model <- lm(Reaction ~ days_deprived + Subject + days_deprived:Subject,"
"0","               data = sleep2)"
"0","  summary(np_model)"
"1","
Call:
"
"1",""
"1","lm(formula = Reaction ~ days_deprived + Subject + days_deprived:Subject, 
    data = sleep2)"
"1",""
"1","

"
"1",""
"1","Residuals:
"
"1","     Min "
"1","      1Q "
"1","  Median "
"1","      3Q "
"1","     Max "
"1","
"
"1","-106.521 "
"1","  -8.541 "
"1","   1.143 "
"1","   8.889 "
"1"," 128.545 "
"1","
"
"1","
Coefficients:
"
"1","                        "
"1"," Estimate"
"1"," Std. Error"
"1"," t value"
"1"," Pr(>|t|)"
"1","    "
"1","
(Intercept)             "
"1"," 288.2175"
"1","    16.4772"
"1","  17.492"
"1","  < 2e-16"
"1"," ***"
"1","
days_deprived           "
"1","  21.6905"
"1","     3.9388"
"1","   5.507"
"1"," 2.49e-07"
"1"," ***"
"1","
Subject309              "
"1"," -87.9262"
"1","    23.3023"
"1","  -3.773"
"1"," 0.000264"
"1"," ***"
"1","
Subject310              "
"1"," -62.2856"
"1","    23.3023"
"1","  -2.673"
"1"," 0.008685"
"1"," ** "
"1","
Subject330              "
"1"," -14.9533"
"1","    23.3023"
"1","  -0.642"
"1"," 0.522422"
"1","    "
"1","
Subject331              "
"1","   9.9658"
"1","    23.3023"
"1","   0.428"
"1"," 0.669740"
"1","    "
"1","
Subject332              "
"1","  27.8157"
"1","    23.3023"
"1","   1.194"
"1"," 0.235215"
"1","    "
"1","
Subject333              "
"1","  -2.7581"
"1","    23.3023"
"1","  -0.118"
"1"," 0.906000"
"1","    "
"1","
Subject334              "
"1"," -50.2051"
"1","    23.3023"
"1","  -2.155"
"1"," 0.033422"
"1"," *  "
"1","
Subject335              "
"1"," -25.3429"
"1","    23.3023"
"1","  -1.088"
"1"," 0.279207"
"1","    "
"1","
Subject337              "
"1","  24.6143"
"1","    23.3023"
"1","   1.056"
"1"," 0.293187"
"1","    "
"1","
Subject349              "
"1"," -59.2183"
"1","    23.3023"
"1","  -2.541"
"1"," 0.012464"
"1"," *  "
"1","
Subject350              "
"1"," -40.2023"
"1","    23.3023"
"1","  -1.725"
"1"," 0.087343"
"1"," .  "
"1","
Subject351              "
"1"," -24.2467"
"1","    23.3023"
"1","  -1.041"
"1"," 0.300419"
"1","    "
"1","
Subject352              "
"1","  43.0655"
"1","    23.3023"
"1","   1.848"
"1"," 0.067321"
"1"," .  "
"1","
Subject369              "
"1"," -21.5040"
"1","    23.3023"
"1","  -0.923"
"1"," 0.358154"
"1","    "
"1","
Subject370              "
"1"," -53.3072"
"1","    23.3023"
"1","  -2.288"
"1"," 0.024107"
"1"," *  "
"1","
Subject371              "
"1"," -30.4896"
"1","    23.3023"
"1","  -1.308"
"1"," 0.193504"
"1","    "
"1","
Subject372              "
"1","   2.4772"
"1","    23.3023"
"1","   0.106"
"1"," 0.915535"
"1","    "
"1","
days_deprived:Subject309"
"1"," -17.3334"
"1","     5.5703"
"1","  -3.112"
"1"," 0.002380"
"1"," ** "
"1","
days_deprived:Subject310"
"1"," -17.7915"
"1","     5.5703"
"1","  -3.194"
"1"," 0.001839"
"1"," ** "
"1","
days_deprived:Subject330"
"1"," -13.6849"
"1","     5.5703"
"1","  -2.457"
"1"," 0.015613"
"1"," *  "
"1","
days_deprived:Subject331"
"1"," -16.8231"
"1","     5.5703"
"1","  -3.020"
"1"," 0.003154"
"1"," ** "
"1","
days_deprived:Subject332"
"1"," -19.2947"
"1","     5.5703"
"1","  -3.464"
"1"," 0.000765"
"1"," ***"
"1","
days_deprived:Subject333"
"1"," -10.8151"
"1","     5.5703"
"1","  -1.942"
"1"," 0.054796"
"1"," .  "
"1","
days_deprived:Subject334"
"1","  -3.5745"
"1","     5.5703"
"1","  -0.642"
"1"," 0.522423"
"1","    "
"1","
days_deprived:Subject335"
"1"," -25.8995"
"1","     5.5703"
"1","  -4.650"
"1"," 9.47e-06"
"1"," ***"
"1","
days_deprived:Subject337"
"1","   0.7518"
"1","     5.5703"
"1","   0.135"
"1"," 0.892895"
"1","    "
"1","
days_deprived:Subject349"
"1","  -5.2644"
"1","     5.5703"
"1","  -0.945"
"1"," 0.346731"
"1","    "
"1","
days_deprived:Subject350"
"1","   1.6007"
"1","     5.5703"
"1","   0.287"
"1"," 0.774382"
"1","    "
"1","
days_deprived:Subject351"
"1"," -13.1681"
"1","     5.5703"
"1","  -2.364"
"1"," 0.019867"
"1"," *  "
"1","
days_deprived:Subject352"
"1"," -14.4019"
"1","     5.5703"
"1","  -2.585"
"1"," 0.011057"
"1"," *  "
"1","
days_deprived:Subject369"
"1","  -7.8948"
"1","     5.5703"
"1","  -1.417"
"1"," 0.159273"
"1","    "
"1","
days_deprived:Subject370"
"1","  -1.0495"
"1","     5.5703"
"1","  -0.188"
"1"," 0.850912"
"1","    "
"1","
days_deprived:Subject371"
"1","  -9.3443"
"1","     5.5703"
"1","  -1.678"
"1"," 0.096334"
"1"," .  "
"1","
days_deprived:Subject372"
"1"," -10.6041"
"1","     5.5703"
"1","  -1.904"
"1"," 0.059613"
"1"," .  "
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
Residual standard error:"
"1"," "
"1","25.53"
"1"," "
"1","on"
"1"," "
"1","108"
"1"," "
"1","degrees of freedom"
"1","
"
"1","Multiple R-squared: "
"1"," "
"1","0.849"
"1",",	Adjusted R-squared: "
"1"," "
"1","0.8001"
"1"," "
"1","
F-statistic:"
"1"," "
"1","17.35"
"1"," "
"1","on"
"1"," "
"1","35"
"1"," "
"1","and"
"1"," "
"1","108"
"1"," "
"1","DF,  p-value:"
"1"," "
"1","< 2.2e-16"
"1","
"
"1","
"
"0","all_intercepts <- c(coef(np_model)[""(Intercept)""],"
"0","                    coef(np_model)[3:19] + coef(np_model)[""(Intercept)""])"
"0","all_slopes  <- c(coef(np_model)[""days_deprived""],"
"0","                 coef(np_model)[20:36] + coef(np_model)[""days_deprived""])"
"0","ids <- sleep2 %>% pull(Subject) %>% levels() %>% factor()"
"0","np_coef <- tibble(Subject = ids,"
"0","                  intercept = all_intercepts,"
"0","                  slope = all_slopes)"
"0","np_coef"
